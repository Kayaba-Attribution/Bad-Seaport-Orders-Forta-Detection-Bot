'use strict';const a1_0x294f7c=a1_0xde74;(function(_0x134916,_0x3c717a){const _0x52fcbc=a1_0xde74,_0x4b394c=_0x134916();while(!![]){try{const _0x2b8b43=parseInt(_0x52fcbc(0x13b))/0x1+parseInt(_0x52fcbc(0x152))/0x2+parseInt(_0x52fcbc(0x157))/0x3+-parseInt(_0x52fcbc(0x14d))/0x4+-parseInt(_0x52fcbc(0x16a))/0x5+-parseInt(_0x52fcbc(0x127))/0x6*(-parseInt(_0x52fcbc(0x118))/0x7)+parseInt(_0x52fcbc(0x137))/0x8*(parseInt(_0x52fcbc(0x11d))/0x9);if(_0x2b8b43===_0x3c717a)break;else _0x4b394c['push'](_0x4b394c['shift']());}catch(_0x405469){_0x4b394c['push'](_0x4b394c['shift']());}}}(a1_0x1227,0xda21b));function a1_0xde74(_0x5e6c0c,_0x385f39){const _0x122754=a1_0x1227();return a1_0xde74=function(_0xde7487,_0x554419){_0xde7487=_0xde7487-0x113;let _0x87d0ec=_0x122754[_0xde7487];return _0x87d0ec;},a1_0xde74(_0x5e6c0c,_0x385f39);}var __createBinding=this&&this[a1_0x294f7c(0x154)]||(Object[a1_0x294f7c(0x122)]?function(_0x3f4b15,_0x54506f,_0x481a48,_0x3f9d8f){const _0x2acd57=a1_0x294f7c;if(_0x3f9d8f===undefined)_0x3f9d8f=_0x481a48;var _0x463f37=Object['getOwnPropertyDescriptor'](_0x54506f,_0x481a48);(!_0x463f37||(_0x2acd57(0x159)in _0x463f37?!_0x54506f['__esModule']:_0x463f37[_0x2acd57(0x11c)]||_0x463f37[_0x2acd57(0x148)]))&&(_0x463f37={'enumerable':!![],'get':function(){return _0x54506f[_0x481a48];}}),Object[_0x2acd57(0x126)](_0x3f4b15,_0x3f9d8f,_0x463f37);}:function(_0x38866e,_0x10d634,_0x2fc17,_0x5df2d8){if(_0x5df2d8===undefined)_0x5df2d8=_0x2fc17;_0x38866e[_0x5df2d8]=_0x10d634[_0x2fc17];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x4dc0bb,_0x3cc56e){const _0x44f68c=a1_0x294f7c;Object[_0x44f68c(0x126)](_0x4dc0bb,_0x44f68c(0x166),{'enumerable':!![],'value':_0x3cc56e});}:function(_0x3cb137,_0x46aa3e){const _0x56ea6c=a1_0x294f7c;_0x3cb137[_0x56ea6c(0x166)]=_0x46aa3e;}),__importStar=this&&this['__importStar']||function(_0x2da127){const _0x4cd28f=a1_0x294f7c;if(_0x2da127&&_0x2da127['__esModule'])return _0x2da127;var _0x131024={};if(_0x2da127!=null){for(var _0x2cf8fa in _0x2da127)if(_0x2cf8fa!=='default'&&Object['prototype'][_0x4cd28f(0x11b)][_0x4cd28f(0x15a)](_0x2da127,_0x2cf8fa))__createBinding(_0x131024,_0x2da127,_0x2cf8fa);}return __setModuleDefault(_0x131024,_0x2da127),_0x131024;},__importDefault=this&&this[a1_0x294f7c(0x13f)]||function(_0x476c4b){return _0x476c4b&&_0x476c4b['__esModule']?_0x476c4b:{'default':_0x476c4b};};Object[a1_0x294f7c(0x126)](exports,a1_0x294f7c(0x12a),{'value':!![]});function a1_0x1227(){const _0x2857e8=['9911','__importDefault','Creates\x20a\x20critical\x20sale\x20alert\x20connecting\x20an\x20attacker\x20to\x20a\x20sell\x20of\x20stolen\x20assets','Opensea\x20ðŸŒŠ','ethereum','log','Seaport\x201.1\x20ERC721\x20Transfer','Finding','6696','tuple[]','configurable','toStrictEqual','0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef','ETH','nftContract','5587148pBvenY','TST','100','ethers','6262','1488112BtYNaR','toBe','__createBinding','MHC','666,','549456COcDco','parseEther','get','call','1,2','substring','0x0000000000000000000000000000000000000000','consideration','Mutant\x20Hound\x20Collars','name','labels','address','TestNFT','uint256','returns\x20critial\x20finding\x20for\x20a\x20NFT\x20sale\x20for\x20very\x20low\x20value\x20and\x20check\x20that\x20is\x20stored.','default','./agent','0x002','utils','2460050JrEbCl','ERC721','token','encodeParameters','offer','Wallet','createRandom','createTransactionEvent','9791','707PXSJcf','entity','uint8','hasOwnProperty','writable','18UnqLkd','keccak256','orderHash','amount','description','create','0x0','encodeParameter','1\x20stolenNFT\x20id/s:\x20666\x20sold\x20on\x20Opensea\x20ðŸŒŠ\x20for\x200.001\x20ETH\x20with\x20a\x20floor\x20price\x20of\x2010\x20ETH','defineProperty','101346CgNaru','push','8273','__esModule','handleTransaction','identifier','itemType','length','toString','setTimeout','storage','toLowerCase','SeaPort\x201.1\x20NFTs\x20transfers\x20and\x20phishing\x20tracking','logs','high\x20tether\x20transfer\x20agent','0x001','405536TgUihv','0x4b1f94a7fc5ca5bb74bde07406c1187b0d4dc12c4aacb11972cf2e7fe5fc9608','NftTokenType','0x00000000006c3852cbef3e08e8df289169ede581','47681UKbVUg','bytes32','forta-agent'];a1_0x1227=function(){return _0x2857e8;};return a1_0x1227();}const forta_agent_1=require(a1_0x294f7c(0x13d)),agent_1=__importStar(require(a1_0x294f7c(0x167))),web3_eth_abi_1=__importDefault(require('web3-eth-abi')),alchemy_sdk_1=require('alchemy-sdk'),openSeaLogJSON=[{'type':a1_0x294f7c(0x13c),'name':a1_0x294f7c(0x11f)},{'type':a1_0x294f7c(0x162),'name':'recipient'},{'type':a1_0x294f7c(0x147),'name':a1_0x294f7c(0x113),'components':[{'type':a1_0x294f7c(0x11a),'name':a1_0x294f7c(0x12d)},{'type':a1_0x294f7c(0x162),'name':a1_0x294f7c(0x16c)},{'type':a1_0x294f7c(0x164),'name':a1_0x294f7c(0x12c)},{'type':a1_0x294f7c(0x164),'name':a1_0x294f7c(0x120)}]},{'type':a1_0x294f7c(0x147),'name':a1_0x294f7c(0x15e),'components':[{'type':a1_0x294f7c(0x11a),'name':'itemType'},{'type':a1_0x294f7c(0x162),'name':a1_0x294f7c(0x16c)},{'type':'uint256','name':a1_0x294f7c(0x12c)},{'type':a1_0x294f7c(0x164),'name':a1_0x294f7c(0x120)},{'type':'address','name':'recipient'}]}],createBatchContractInfo=(_0x24a4f9,_0x4d3a7b,_0xc4e652,_0x1915aa,_0x43fb00,_0x9ce7a3,_0x5dbce3,_0x41743b,_0x14d97f,_0x2e9f1f,_0x53308e)=>{const _0x4e7269=a1_0x294f7c;let _0x5403e0=[],_0x32b19b=_0x24a4f9;const _0x8f86d9={'floorPrice':_0x5dbce3},_0x2f8665={'address':_0x32b19b,'contractMetadata':{'name':_0x4d3a7b,'symbol':_0xc4e652,'totalSupply':_0x1915aa,'tokenType':_0x43fb00=='ERC721'?alchemy_sdk_1[_0x4e7269(0x139)][_0x4e7269(0x16b)]:alchemy_sdk_1[_0x4e7269(0x139)]['ERC1155'],'contractDeployer':'0x999','deployedBlockNumber':0x3e7,'openSea':_0x8f86d9,'address':_0x32b19b}},_0x4295f7=web3_eth_abi_1['default'][_0x4e7269(0x16d)](openSeaLogJSON,['0x1b258db8d5c9f6842b522df8b87715dbb2827e1b1f761ca7ca06d01c3baa9ae3','0x00000000006c3852cbef3e08e8df289169ede581',[{'itemType':_0x4e7269(0x123),'token':_0x24a4f9,'identifier':_0x4e7269(0x123),'amount':forta_agent_1['ethers'][_0x4e7269(0x169)]['parseEther'](_0x9ce7a3[_0x4e7269(0x12f)]())}],[{'itemType':'0x0','token':_0x4e7269(0x15d),'identifier':_0x4e7269(0x123),'amount':forta_agent_1[_0x4e7269(0x150)][_0x4e7269(0x169)][_0x4e7269(0x158)](_0x9ce7a3['toString']()),'recipient':_0x4e7269(0x13a)}]]),_0x63968c=(0x0,forta_agent_1[_0x4e7269(0x116)])({'transaction':{'hash':_0x53308e,'to':_0x4e7269(0x13a)},'addresses':{'0x00000000006c3852cbef3e08e8df289169ede581':!![],'nftContract':!![]},'logs':[{'address':'0x00000000006c3852cbef3e08e8df289169ede581','topics':['0x9d9af8e38d66c62e2c12f0225249fd9d721c54b83f48d9352c97c6cacdcb6f31',web3_eth_abi_1[_0x4e7269(0x166)][_0x4e7269(0x124)](_0x4e7269(0x162),_0x41743b),web3_eth_abi_1['default'][_0x4e7269(0x124)](_0x4e7269(0x162),_0x14d97f)],'data':_0x4295f7,'logIndex':0x1,'blockNumber':0xf773b4,'blockHash':_0x4e7269(0x138),'transactionIndex':0x1,'transactionHash':_0x53308e,'removed':![]}]});if(_0x2e9f1f instanceof Array)for(let _0x597a00=0x0;_0x597a00<_0x2e9f1f[_0x4e7269(0x12e)];_0x597a00++){let _0x14cde8={'address':_0x24a4f9,'topics':[_0x4e7269(0x14a),web3_eth_abi_1[_0x4e7269(0x166)]['encodeParameter'](_0x4e7269(0x162),_0x41743b),web3_eth_abi_1['default']['encodeParameter']('address',_0x14d97f),web3_eth_abi_1[_0x4e7269(0x166)][_0x4e7269(0x124)](_0x4e7269(0x164),_0x2e9f1f[_0x597a00])],'data':'0x','logIndex':_0x597a00+0x1,'blockNumber':0xf773b4,'blockHash':_0x4e7269(0x138),'transactionIndex':0x1+0x1,'transactionHash':_0x53308e,'removed':![]};_0x63968c[_0x4e7269(0x134)][_0x4e7269(0x128)](_0x14cde8);}else _0x63968c[_0x4e7269(0x134)]['push']({'address':_0x24a4f9,'topics':[_0x4e7269(0x14a),web3_eth_abi_1[_0x4e7269(0x166)][_0x4e7269(0x124)]('address',_0x41743b),web3_eth_abi_1[_0x4e7269(0x166)]['encodeParameter']('address',_0x14d97f),web3_eth_abi_1[_0x4e7269(0x166)][_0x4e7269(0x124)](_0x4e7269(0x164),_0x2e9f1f)],'data':'0x','logIndex':0x2,'blockNumber':0xf773b4,'blockHash':_0x4e7269(0x138),'transactionIndex':0x2,'transactionHash':_0x53308e,'removed':![]});return _0x5403e0[_0x4e7269(0x128)](_0x2f8665),[_0x5403e0,_0x63968c];};function createRandomAddress(){const _0x2d513c=a1_0x294f7c;let _0x565329=(Math['random']()+0x1)['toString'](0x24)[_0x2d513c(0x15c)](0x7);return forta_agent_1['ethers'][_0x2d513c(0x114)][_0x2d513c(0x115)]([_0x565329])['address'][_0x2d513c(0x132)]();}jest[a1_0x294f7c(0x130)](0x1388),describe(a1_0x294f7c(0x135),()=>{const _0x24b506=a1_0x294f7c;let _0x2b38b3,_0x302c36,_0x333526,_0x27c65e,_0x2599c5;beforeAll(()=>{const _0x52fe67=a1_0xde74;_0x2b38b3=agent_1[_0x52fe67(0x166)][_0x52fe67(0x12b)],_0x302c36=createRandomAddress(),_0x333526=createRandomAddress(),_0x27c65e=createRandomAddress(),_0x2599c5=createRandomAddress();}),describe(_0x24b506(0x133),()=>{const _0xa06c7c=_0x24b506;it(_0xa06c7c(0x140),async()=>{const _0xa18500=_0xa06c7c;let _0x6812ce=createRandomAddress(),[_0x312bd4,_0x2096f7]=createBatchContractInfo(_0x6812ce,_0xa18500(0x15f),'MHC','100',_0xa18500(0x16b),0.001,0.58,_0x302c36,_0x333526,[_0xa18500(0x151),_0xa18500(0x146),_0xa18500(0x129),_0xa18500(0x117),_0xa18500(0x13e)],_0xa18500(0x136));const _0x3963d5=await _0x2b38b3(_0x2096f7,_0x312bd4);expect(agent_1[_0xa18500(0x131)][_0xa18500(0x12e)])[_0xa18500(0x153)](0x1),expect(_0x3963d5[0x0]['labels'][0x0][_0xa18500(0x119)])[_0xa18500(0x153)](_0x333526),expect(_0x3963d5[0x0][_0xa18500(0x161)][0x1]['entity'])[_0xa18500(0x153)](_0x302c36),expect(_0x3963d5[0x0][_0xa18500(0x161)][0x2][_0xa18500(0x119)])[_0xa18500(0x153)]('6262,'+_0x6812ce),[_0x312bd4,_0x2096f7]=createBatchContractInfo(_0x6812ce,'Mutant\x20Hound\x20Collars',_0xa18500(0x155),'100',_0xa18500(0x16b),0.56,0.58,_0x333526,_0x27c65e,['6262'],_0xa18500(0x168));const _0x575bb5=await _0x2b38b3(_0x2096f7,_0x312bd4);console[_0xa18500(0x143)](_0x575bb5);}),it(_0xa06c7c(0x165),async()=>{const _0xbf77e3=_0xa06c7c;let _0x542327=createRandomAddress(),[_0x39a342,_0x5e0fb7]=createBatchContractInfo(_0x542327,'stolenNFT','SNFT',_0xbf77e3(0x14f),_0xbf77e3(0x16b),0.001,0xa,_0x302c36,_0x333526,['666'],_0xbf77e3(0x168));const _0x94c04d=await _0x2b38b3(_0x5e0fb7,_0x39a342);expect(agent_1[_0xbf77e3(0x131)][_0xbf77e3(0x12e)])[_0xbf77e3(0x153)](0x2),expect(_0x94c04d[0x0][_0xbf77e3(0x160)])[_0xbf77e3(0x153)]('Seaport\x201.1\x20ERC721\x20Phishing\x20Transfer'),expect(_0x94c04d[0x0]['severity'])[_0xbf77e3(0x153)](0x5),expect(_0x94c04d[0x0][_0xbf77e3(0x121)])[_0xbf77e3(0x153)](_0xbf77e3(0x125)),expect(_0x94c04d[0x0][_0xbf77e3(0x161)][0x0]['entity'])[_0xbf77e3(0x153)](_0x333526),expect(_0x94c04d[0x0][_0xbf77e3(0x161)][0x1]['entity'])[_0xbf77e3(0x153)](_0x302c36),expect(_0x94c04d[0x0][_0xbf77e3(0x161)][0x2]['entity'])['toBe'](_0xbf77e3(0x156)+_0x542327);}),it('returns\x20an\x20informational\x20finding\x20for\x20a\x20regular\x20NFTs\x20transfer',async()=>{const _0x23d928=_0xa06c7c;let _0x449ee7=createRandomAddress(),[_0x3603ba,_0x4a4d0b]=createBatchContractInfo(_0x449ee7,_0x23d928(0x163),_0x23d928(0x14e),_0x23d928(0x14f),'ERC721',0x9,0xa,_0x27c65e,_0x2599c5,['1','2'],_0x23d928(0x136));const _0x45d630=await _0x2b38b3(_0x4a4d0b,_0x3603ba);console[_0x23d928(0x143)](_0x45d630),expect(_0x45d630)[_0x23d928(0x149)]([forta_agent_1[_0x23d928(0x145)]['fromObject']({'name':_0x23d928(0x144),'description':'Regular\x20NFT\x20Transfer','alertId':forta_agent_1[_0x23d928(0x150)][_0x23d928(0x169)][_0x23d928(0x11e)](forta_agent_1[_0x23d928(0x150)][_0x23d928(0x169)]['toUtf8Bytes'](_0x23d928(0x136)+_0x449ee7)),'protocol':_0x23d928(0x142),'severity':0x2,'type':0x4,'metadata':{'contractName':'TestNFT','quantity':'2','itemPrice':'4.5','collectionFloor':'10','fromAddr':_0x27c65e,'toAddr':_0x2599c5,'tokenIds':_0x23d928(0x15b),'market':_0x23d928(0x141),'currency':_0x23d928(0x14b),'totalPrice':'9','hash':_0x23d928(0x136),'contractAddress':_0x449ee7},'addresses':[_0x2599c5[_0x23d928(0x132)](),_0x27c65e['toLowerCase'](),_0x23d928(0x14c)],'labels':[]})]);});});});