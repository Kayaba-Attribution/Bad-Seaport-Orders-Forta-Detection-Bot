'use strict';function a6_0x4ded(_0x53f63a,_0x203c85){const _0x346e0d=a6_0x346e();return a6_0x4ded=function(_0x4ded7a,_0x91feda){_0x4ded7a=_0x4ded7a-0x9e;let _0x4f329e=_0x346e0d[_0x4ded7a];return _0x4f329e;},a6_0x4ded(_0x53f63a,_0x203c85);}const a6_0x474ddf=a6_0x4ded;(function(_0x256229,_0x59b9b2){const _0x42b91b=a6_0x4ded,_0x45e95c=_0x256229();while(!![]){try{const _0x591f4b=-parseInt(_0x42b91b(0xdb))/0x1+-parseInt(_0x42b91b(0xe1))/0x2+parseInt(_0x42b91b(0xbc))/0x3*(-parseInt(_0x42b91b(0xbb))/0x4)+-parseInt(_0x42b91b(0xf7))/0x5*(-parseInt(_0x42b91b(0xe6))/0x6)+-parseInt(_0x42b91b(0xca))/0x7+-parseInt(_0x42b91b(0xa0))/0x8+parseInt(_0x42b91b(0x9f))/0x9;if(_0x591f4b===_0x59b9b2)break;else _0x45e95c['push'](_0x45e95c['shift']());}catch(_0x13fd0c){_0x45e95c['push'](_0x45e95c['shift']());}}}(a6_0x346e,0x433cd));var __importDefault=this&&this[a6_0x474ddf(0xdd)]||function(_0x1a5319){const _0x46c6c4=a6_0x474ddf;return _0x1a5319&&_0x1a5319[_0x46c6c4(0xef)]?_0x1a5319:{'default':_0x1a5319};};Object[a6_0x474ddf(0xad)](exports,a6_0x474ddf(0xef),{'value':!![]}),exports[a6_0x474ddf(0xd4)]=void 0x0;const lodash_1=__importDefault(require('lodash')),forta_agent_1=require(a6_0x474ddf(0xa6)),ethers_1=require('ethers'),web3_eth_abi_1=__importDefault(require(a6_0x474ddf(0xd3))),markets_js_1=require(a6_0x474ddf(0xc2)),currencies_js_1=require(a6_0x474ddf(0xd5)),logEventTypes_js_1=require(a6_0x474ddf(0xb1)),initialize_js_1=require('../config/initialize.js'),parseSeaport_js_1=require(a6_0x474ddf(0xec)),parseSaleToken_js_1=require('./parseSaleToken.js'),api_js_1=require(a6_0x474ddf(0xe4)),isSeaport=_0x45cb9e=>{const _0x5d4236=a6_0x474ddf;return _0x45cb9e[_0x5d4236(0xcc)]!==undefined;};async function transferIndexer(_0x300698,_0x20fb13){const _0x1c303c=a6_0x474ddf;var _0x2efaa4,_0xc95cc2,_0x442f8b;const _0x2ecfb8=_0x20fb13[_0x1c303c(0xae)],_0xaa4bb6=_0x300698[_0x1c303c(0xe3)][_0x1c303c(0xee)];let _0x4dffda=_0x300698['to']?_0x300698['to']:'';if(!(_0x4dffda[_0x1c303c(0xcd)]()in markets_js_1[_0x1c303c(0xb6)]))return[];const _0x51114c=(0x0,initialize_js_1[_0x1c303c(0xf3)])(_0xaa4bb6,_0x20fb13['contractMetadata'],_0x4dffda,_0x2ecfb8);for(const _0x1369e4 of _0x300698[_0x1c303c(0xd8)]){const _0x106b60=_0x1369e4[_0x1c303c(0xae)][_0x1c303c(0xcd)](),_0x1a5808=lodash_1[_0x1c303c(0xc1)][_0x1c303c(0xa1)](markets_js_1['markets'],_0x106b60);_0x106b60 in currencies_js_1[_0x1c303c(0xce)]&&(_0x51114c[_0x1c303c(0xb2)]=currencies_js_1[_0x1c303c(0xce)][_0x106b60]);(0x0,parseSaleToken_js_1['parseSaleToken'])(_0x51114c,_0x1369e4,_0x106b60);const _0x321d3b=_0x106b60===_0x4dffda&&logEventTypes_js_1['saleEventTypes']['includes'](_0x1369e4[_0x1c303c(0xe9)][0x0]),_0x112775=logEventTypes_js_1[_0x1c303c(0xf1)][_0x1c303c(0xbd)](_0x1369e4[_0x1c303c(0xe9)][0x0]);if(_0x321d3b){const _0x45dd44=_0x321d3b?_0x51114c['market']['logDecoder']:markets_js_1[_0x1c303c(0xb6)][_0x106b60][_0x1c303c(0xcf)];if(_0x45dd44===undefined)return null;const _0xf7896e=web3_eth_abi_1['default'][_0x1c303c(0xc4)](_0x45dd44,_0x1369e4[_0x1c303c(0xab)],[]);if(isSeaport(_0xf7896e)){const _0x412c65=(0x0,parseSeaport_js_1[_0x1c303c(0xc0)])(_0x51114c,_0x1369e4,_0x1a5808,_0xf7896e);if(_0x412c65===![])continue;}}}_0x51114c[_0x1c303c(0xdc)]=_0x51114c[_0x1c303c(0xc9)]===_0x1c303c(0xd1)?_0x51114c['tokens'][_0x1c303c(0xf5)]:lodash_1[_0x1c303c(0xc1)]['sum'](_0x51114c[_0x1c303c(0xde)]);if(_0x51114c[_0x1c303c(0xdc)]===0x0)return console[_0x1c303c(0xa3)](_0x1c303c(0xc6)+_0xaa4bb6+'\x0a'),null;_0x51114c['to']=await(0x0,api_js_1[_0x1c303c(0xa4)])((_0x2efaa4=_0x51114c[_0x1c303c(0xb3)])!==null&&_0x2efaa4!==void 0x0?_0x2efaa4:''),_0x51114c[_0x1c303c(0xd7)]=await(0x0,api_js_1[_0x1c303c(0xa4)])((_0xc95cc2=_0x51114c[_0x1c303c(0xc3)])!==null&&_0xc95cc2!==void 0x0?_0xc95cc2:''),_0x51114c['floor']=(_0x442f8b=_0x20fb13[_0x1c303c(0xea)][_0x1c303c(0xb5)])===null||_0x442f8b===void 0x0?void 0x0:_0x442f8b[_0x1c303c(0xbe)],_0x51114c[_0x1c303c(0xb9)]=_0x51114c[_0x1c303c(0xf0)]||_0x51114c[_0x1c303c(0xe8)]+'\x20#'+_0x51114c[_0x1c303c(0xd0)],_0x51114c[_0x1c303c(0xb8)]=_0x51114c[_0x1c303c(0xb2)][_0x1c303c(0xcb)]===_0x1c303c(0xb0)||_0x51114c[_0x1c303c(0xb2)][_0x1c303c(0xcb)]===_0x1c303c(0xc8)?await(0x0,api_js_1[_0x1c303c(0xf6)])(_0x51114c[_0x1c303c(0xf2)]):null,_0x51114c[_0x1c303c(0xa9)]=_0x51114c[_0x1c303c(0xb8)]?'($\x20'+_0x51114c[_0x1c303c(0xb8)]+')':'';const {tokenName:_0x47758f,contractName:_0x22fad7,market:_0x376de3,totalPrice:_0x734998,currency:_0x4c2bd0,quantity:_0x38379e,fromAddr:_0x4aeef5,toAddr:_0x4cac9c}=_0x51114c;if(_0x51114c){console[_0x1c303c(0xaa)](_0x38379e+'\x20'+(_0x22fad7||_0x47758f)+_0x1c303c(0xe7)+_0x376de3[_0x1c303c(0xe0)]+_0x1c303c(0xe5)+_0x734998+'\x20'+_0x4c2bd0[_0x1c303c(0xcb)]);let _0x5edfbe=_0x734998/_0x38379e,_0x5d5024=_0x51114c[_0x1c303c(0xc9)]===_0x1c303c(0xd1)?_0x51114c['tokens'][_0x1c303c(0xb4)]():_0x51114c['tokenId'],_0x2beed2=ethers_1['utils'][_0x1c303c(0xdf)](ethers_1[_0x1c303c(0xba)][_0x1c303c(0xa5)](_0xaa4bb6+_0x2ecfb8));if(_0x5edfbe<_0x51114c[_0x1c303c(0xd9)]*0.01){let _0x52116e=forta_agent_1[_0x1c303c(0xa7)][_0x1c303c(0xaf)]({'name':_0x1c303c(0xac)+_0x51114c[_0x1c303c(0xc9)]+_0x1c303c(0xbf),'description':_0x38379e+'\x20'+(_0x22fad7||_0x47758f)+_0x1c303c(0xed)+_0x5d5024+_0x1c303c(0xe7)+_0x376de3[_0x1c303c(0xe0)]+_0x1c303c(0xe5)+_0x734998+'\x20'+_0x4c2bd0[_0x1c303c(0xcb)]+_0x1c303c(0xd6)+_0x51114c['floor']+'\x20'+_0x4c2bd0[_0x1c303c(0xcb)],'alertId':_0x2beed2,'severity':forta_agent_1[_0x1c303c(0xc7)][_0x1c303c(0xf8)],'type':forta_agent_1[_0x1c303c(0xd2)]['Exploit'],'metadata':{'contractName':_0x22fad7,'quantity':_0x38379e[_0x1c303c(0xb4)](),'itemPrice':_0x5edfbe[_0x1c303c(0xb4)](),'collectionFloor':_0x51114c['floor']['toString'](),'fromAddr':_0x4aeef5[_0x1c303c(0xcd)](),'toAddr':_0x4cac9c[_0x1c303c(0xcd)](),'tokenIds':_0x5d5024,'market':_0x376de3['displayName'],'currency':_0x4c2bd0===null||_0x4c2bd0===void 0x0?void 0x0:_0x4c2bd0[_0x1c303c(0xcb)],'totalPrice':_0x734998['toString'](),'hash':_0xaa4bb6,'contractAddress':_0x2ecfb8},'labels':[{'entityType':forta_agent_1[_0x1c303c(0xda)][_0x1c303c(0xeb)],'entity':_0x4cac9c[_0x1c303c(0xcd)](),'label':_0x1c303c(0xc5),'confidence':0.9,'remove':![]},{'entityType':forta_agent_1[_0x1c303c(0xda)][_0x1c303c(0xeb)],'entity':_0x4aeef5['toLowerCase'](),'label':_0x1c303c(0x9e),'confidence':0.9,'remove':![]}]}),_0x4204ed=_0x5d5024['split'](',');for(const _0x41db90 of _0x4204ed){_0x52116e[_0x1c303c(0xe2)]['push']({'entityType':forta_agent_1[_0x1c303c(0xda)]['Address'],'entity':_0x41db90+','+_0x2ecfb8,'label':_0x1c303c(0xa2),'confidence':0.9,'remove':![]});}return _0x52116e;}else return forta_agent_1['Finding'][_0x1c303c(0xaf)]({'name':_0x1c303c(0xac)+_0x51114c[_0x1c303c(0xc9)]+_0x1c303c(0xa8),'description':'Regular\x20NFT\x20Transfer','alertId':_0x2beed2,'severity':forta_agent_1[_0x1c303c(0xc7)][_0x1c303c(0xf4)],'type':forta_agent_1[_0x1c303c(0xd2)][_0x1c303c(0xb7)],'metadata':{'contractName':_0x22fad7,'quantity':_0x38379e[_0x1c303c(0xb4)](),'itemPrice':_0x5edfbe[_0x1c303c(0xb4)](),'collectionFloor':_0x51114c['floor']['toString'](),'fromAddr':_0x4aeef5[_0x1c303c(0xcd)](),'toAddr':_0x4cac9c[_0x1c303c(0xcd)](),'tokenIds':_0x5d5024,'market':_0x376de3[_0x1c303c(0xe0)],'currency':(_0x4c2bd0===null||_0x4c2bd0===void 0x0?void 0x0:_0x4c2bd0[_0x1c303c(0xcb)])||_0x1c303c(0xb0),'totalPrice':_0x734998[_0x1c303c(0xb4)](),'hash':_0xaa4bb6,'contractAddress':_0x2ecfb8}});}}function a6_0x346e(){const _0x5f23cb=['tokenName','utils','51676KDbuEF','3ncixxC','includes','floorPrice','\x20Phishing\x20Transfer','parseSeaport','default','../config/markets.js','fromAddr','decodeLog','attacker','\x0a\x20No\x20tokens\x20found.\x20for\x20hash\x20','FindingSeverity','WETH','tokenType','555261gLdzfp','name','offer','toLowerCase','currencies','logDecoder','tokenId','ERC721','FindingType','web3-eth-abi','transferIndexer','../config/currencies.js','\x20with\x20a\x20floor\x20price\x20of\x20','from','logs','floor','EntityType','217082ufjeZp','quantity','__importDefault','tokens','keccak256','displayName','503602YwXLXe','labels','transaction','../utils/api.js','\x20for\x20','24216BDaEoJ','\x20sold\x20on\x20','symbol','topics','contractMetadata','Address','./parseSeaport.js','\x20id/s:\x20','hash','__esModule','contractName','cancelEventTypes','totalPrice','initializeTransactionData','Low','length','getEthUsdPrice','535AoTTkj','Critical','victim','4100877CWQSmq','407800rrLQsx','get','stolen','error','getReadableName','toUtf8Bytes','forta-agent','Finding','\x20Transfer','ethUsdValue','log','data','Seaport\x201.1\x20','defineProperty','address','fromObject','ETH','../config/logEventTypes.js','currency','toAddr','toString','openSea','markets','Info','usdPrice'];a6_0x346e=function(){return _0x5f23cb;};return a6_0x346e();}exports['transferIndexer']=transferIndexer;;