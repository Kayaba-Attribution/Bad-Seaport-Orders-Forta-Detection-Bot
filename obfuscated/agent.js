'use strict';const a0_0x35ea8b=a0_0x1bd3;(function(_0x58101b,_0x16adfa){const _0x294270=a0_0x1bd3,_0x2cac47=_0x58101b();while(!![]){try{const _0x43ab6a=parseInt(_0x294270(0xb8))/0x1*(-parseInt(_0x294270(0x7b))/0x2)+parseInt(_0x294270(0x81))/0x3*(parseInt(_0x294270(0x7a))/0x4)+-parseInt(_0x294270(0x9b))/0x5+parseInt(_0x294270(0x8d))/0x6+-parseInt(_0x294270(0x76))/0x7+-parseInt(_0x294270(0xac))/0x8*(-parseInt(_0x294270(0x91))/0x9)+parseInt(_0x294270(0xa4))/0xa;if(_0x43ab6a===_0x16adfa)break;else _0x2cac47['push'](_0x2cac47['shift']());}catch(_0x4e2254){_0x2cac47['push'](_0x2cac47['shift']());}}}(a0_0x54f6,0x9d5e1));Object[a0_0x35ea8b(0x82)](exports,a0_0x35ea8b(0x90),{'value':!![]}),exports[a0_0x35ea8b(0x8a)]=exports[a0_0x35ea8b(0xae)]=exports[a0_0x35ea8b(0x7d)]=void 0x0;const forta_agent_1=require(a0_0x35ea8b(0xba)),ethers_1=require('ethers'),api_js_1=require(a0_0x35ea8b(0x92)),iso_js_1=require(a0_0x35ea8b(0x9a));function a0_0x54f6(){const _0x281e5d=['Test\x20Data\x20Loaded','attackHash','ERC1155','1lVUKhf','\x20sold\x20','forta-agent','hash','tokenIds','\x20for\x20a\x20aprox\x20profit\x20of\x20','3332378HsIugm','EntityType','run\x20indexer\x20for\x20','tokenType','25528LHQJmO','1204256zDDPGY','itemPrice','SEAPORT_ADDRESS','Exploit','includes','transferIndexer','507QfqsRI','defineProperty','Address','entity','Error\x20in\x20agent','split','entries','fromObject','profit','findingSearch','addresses','\x20id:\x20','4366494OxWWrL','address','buyPrice','__esModule','830052OqJKfO','./utils/api.js','indexOf','default','hasOwnProperty','name','join','severity','metadata','./controllers/iso.js','4336960yiPxlS','FindingSeverity','market','ERC721','push','Critical','log','utils','FindingType','4149320xaGNfQ','fromAddr','length','contractAddress','keccak256','Attacker\x20','\x20stolen\x20from\x20','contractMetadata','32wCOGtS','call','storage','contractName','Finding','Seaport\x201.1\x20NFT\x20Phishing\x20Attacker\x20Sold\x20NFT','toAddr','keys','labels'];a0_0x54f6=function(){return _0x281e5d;};return a0_0x54f6();}exports[a0_0x35ea8b(0x7d)]='0x00000000006c3852cbef3e08e8df289169ede581';let nftContractsData=[];exports[a0_0x35ea8b(0xae)]=[];const findingSearch=_0x31872d=>{const _0x59b383=a0_0x35ea8b;let _0x1090d2;for(const _0x30fa64 of exports[_0x59b383(0xae)]){if(_0x30fa64[_0x59b383(0x99)][_0x59b383(0xa7)]==_0x31872d['metadata'][_0x59b383(0xa7)]&&_0x30fa64[_0x59b383(0x99)]['hash']!==_0x31872d['metadata'][_0x59b383(0xbb)]){let _0x1fa16c=_0x30fa64[_0x59b383(0x99)][_0x59b383(0xbc)][_0x59b383(0x86)](','),_0x355454=_0x31872d[_0x59b383(0x99)][_0x59b383(0xbc)][_0x59b383(0x86)](',');for(const _0x2749fa of _0x1fa16c){if(_0x355454[_0x59b383(0x7f)](_0x2749fa)){let _0x103fe4=_0x31872d[_0x59b383(0x99)];_0x103fe4[_0x59b383(0xb6)]=_0x30fa64[_0x59b383(0x99)][_0x59b383(0xbb)],_0x103fe4[_0x59b383(0x8f)]=_0x30fa64[_0x59b383(0x99)][_0x59b383(0x7c)],_0x103fe4[_0x59b383(0x89)]=(parseFloat(_0x31872d[_0x59b383(0x99)]['totalPrice'])-parseFloat(_0x30fa64[_0x59b383(0x99)][_0x59b383(0x7c)]))['toString'](),_0x1fa16c['splice'](_0x355454[_0x59b383(0x93)](_0x2749fa),0x1),_0x30fa64[_0x59b383(0x99)]['tokenIds']=_0x1fa16c[_0x59b383(0x97)](',');_0x30fa64['metadata'][_0x59b383(0xbc)]===''&&exports[_0x59b383(0xae)]['splice'](exports[_0x59b383(0xae)]['indexOf'](_0x30fa64),0x1);let _0x2ec54d=ethers_1[_0x59b383(0xa2)][_0x59b383(0xa8)](ethers_1[_0x59b383(0xa2)]['toUtf8Bytes'](_0x30fa64[_0x59b383(0x99)][_0x59b383(0xbb)]+_0x30fa64[_0x59b383(0x99)][_0x59b383(0xa7)]));_0x1090d2=forta_agent_1[_0x59b383(0xb0)][_0x59b383(0x88)]({'name':_0x59b383(0xb1),'description':_0x59b383(0xa9)+_0x30fa64['labels'][0x0][_0x59b383(0x84)]+_0x59b383(0xb9)+_0x30fa64['metadata'][_0x59b383(0xaf)]+_0x59b383(0x8c)+_0x2749fa+_0x59b383(0xaa)+_0x30fa64[_0x59b383(0xb4)][0x1]['entity']+'\x20on\x20'+_0x30fa64[_0x59b383(0x99)][_0x59b383(0x9d)]+_0x59b383(0xbd)+_0x103fe4[_0x59b383(0x89)],'alertId':_0x2ec54d,'severity':forta_agent_1[_0x59b383(0x9c)][_0x59b383(0xa0)],'type':forta_agent_1[_0x59b383(0xa3)][_0x59b383(0x7e)],'metadata':_0x103fe4,'labels':[_0x30fa64[_0x59b383(0xb4)][0x0],_0x30fa64[_0x59b383(0xb4)][0x1],{'entityType':forta_agent_1[_0x59b383(0x77)][_0x59b383(0x83)],'entity':_0x31872d[_0x59b383(0x99)][_0x59b383(0xb2)],'label':'buyer','confidence':0.9,'remove':![]},{'entityType':forta_agent_1[_0x59b383(0x77)][_0x59b383(0x83)],'entity':_0x2749fa+','+_0x30fa64[_0x59b383(0x99)][_0x59b383(0xa7)],'label':'stolen','confidence':0.9,'remove':![]}]});}}}}return _0x1090d2===undefined?_0x31872d:_0x1090d2;};exports['findingSearch']=findingSearch;function a0_0x1bd3(_0x5ec25a,_0x1dab49){const _0x54f60d=a0_0x54f6();return a0_0x1bd3=function(_0x1bd32c,_0x731762){_0x1bd32c=_0x1bd32c-0x76;let _0x1b5e21=_0x54f60d[_0x1bd32c];return _0x1b5e21;},a0_0x1bd3(_0x5ec25a,_0x1dab49);}const handleTransaction=async(_0x620734,_0x3eb1e9)=>{const _0x28ade2=a0_0x35ea8b,_0x2a75a6=[];try{if(!_0x620734[_0x28ade2(0x8b)][_0x28ade2(0x95)](exports[_0x28ade2(0x7d)]))return _0x2a75a6;else delete _0x620734[_0x28ade2(0x8b)][exports[_0x28ade2(0x7d)]];!_0x3eb1e9?nftContractsData=await(0x0,api_js_1['getBatchContractData'])(Object[_0x28ade2(0xb3)](_0x620734[_0x28ade2(0x8b)])):(console[_0x28ade2(0xa1)](_0x28ade2(0xb5)),nftContractsData=_0x3eb1e9);for(const _0x1f8e84 of nftContractsData){if(Object[_0x28ade2(0xb3)](_0x1f8e84)[_0x28ade2(0xa6)]!==0x0){if(_0x1f8e84[_0x28ade2(0xab)]['tokenType']===_0x28ade2(0x9e)||_0x1f8e84[_0x28ade2(0xab)][_0x28ade2(0x79)]===_0x28ade2(0xb7)){console[_0x28ade2(0xa1)](_0x28ade2(0x78)+_0x1f8e84['contractMetadata']['name']+'\x20'+_0x1f8e84[_0x28ade2(0x8e)]);let _0x35a057=await(0x0,iso_js_1['transferIndexer'])(_0x620734,_0x1f8e84);if(!_0x35a057)return[];if(!Object['prototype']['hasOwnProperty'][_0x28ade2(0xad)](_0x35a057,_0x28ade2(0x96)))return[];if(_0x35a057[_0x28ade2(0x99)][_0x28ade2(0xb2)])_0x35a057[_0x28ade2(0x8b)][_0x28ade2(0x9f)](_0x35a057[_0x28ade2(0x99)]['toAddr']['toLowerCase']());if(_0x35a057[_0x28ade2(0x99)][_0x28ade2(0xa5)])_0x35a057[_0x28ade2(0x8b)][_0x28ade2(0x9f)](_0x35a057[_0x28ade2(0x99)]['fromAddr']['toLowerCase']());for(const [_0x5168f1,_0x343eb9]of Object[_0x28ade2(0x87)](_0x620734[_0x28ade2(0x8b)])){if(!_0x35a057[_0x28ade2(0x8b)][_0x28ade2(0x7f)](_0x5168f1))_0x35a057[_0x28ade2(0x8b)]['push'](_0x5168f1);}_0x35a057[_0x28ade2(0x98)]===forta_agent_1[_0x28ade2(0x9c)][_0x28ade2(0xa0)]&&(console[_0x28ade2(0xa1)]('CRITICAL\x20ALERT\x20ADDED\x20TO\x20STORAGE',_0x35a057[_0x28ade2(0x99)]['hash']),exports[_0x28ade2(0xae)]['push'](_0x35a057)),_0x2a75a6[_0x28ade2(0x9f)]((0x0,exports[_0x28ade2(0x8a)])(_0x35a057));}}}return _0x2a75a6;}catch(_0x18f165){return console[_0x28ade2(0xa1)]({'message':_0x28ade2(0x85),'error':_0x18f165,'hash':_0x620734['transaction'][_0x28ade2(0xbb)],'storage':exports['storage']}),_0x2a75a6;}};exports[a0_0x35ea8b(0x94)]={'handleTransaction':handleTransaction,'transferIndexer':iso_js_1[a0_0x35ea8b(0x80)],'storage':exports[a0_0x35ea8b(0xae)]};